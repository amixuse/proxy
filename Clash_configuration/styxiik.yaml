redir-port: 7892
mixed-port: 7890
allow-lan: true
bind-address: '*'
mode: rule
ipv6: false
log-level: error
external-controller: 127.0.0.1:9090
bypass:
  - localhost
  - 127.*
  - 10.*
  - 0.*
  - 172.16.*
  - 172.17.*
  - 172.18.*
  - 172.19.*
  - 172.20.*
  - 172.21.*
  - 172.22.*
  - 172.23.*
  - 172.24.*
  - 172.25.*
  - 172.26.*
  - 172.27.*
  - 172.28.*
  - 172.29.*
  - 172.30.*
  - 172.31.*
  - 192.168.*
  - <local>

dns:
  enable: true
  ipv6: false       
  listen: 0.0.0.0:53
  default-nameserver:          
    - 119.29.29.29
    - 223.5.5.5
  nameserver:
    - https://doh.pub/dns-query
    - tls://dot.pub:853
    - https://223.5.5.5/dns-query
    - tls://223.5.5.5:853
  enhanced-mode: fake-ip # or redir-host
  fake-ip-range: 198.18.0.1/16 # Fake IP addresses pool CIDR
  use-hosts: true
  hosts:
#    'doh.pub': 162.14.21.56
#    'dot.pub': 162.14.21.178
  fake-ip-filter:   # fake ip white domain list, aka Always Real IP
    - '*.lan'
    - '+.srv.nintendo.net'
    - '+.stun.playstation.net'
    - '+.msftconnecttest.com'
    - '+.msftncsi.com'
    - '+.xboxlive.com'
    - 'msftconnecttest.com'
    - 'xbox.*.microsoft.com'
    - "dns.msftncsi.com"
    - 'time.windows.com'
    - 'time.nist.gov'
    - 'time.apple.com'
    - 'time.asia.apple.com'
    - '*.ntp.org.cn'
    - '*.openwrt.pool.ntp.org'
    - 'time1.cloud.tencent.com'
    - 'time.ustc.edu.cn'
    - 'pool.ntp.org'
    - 'ntp.ubuntu.com'
    - 'ntp.aliyun.com'
    - 'ntp1.aliyun.com'
    - 'ntp2.aliyun.com'
    - 'ntp3.aliyun.com'
    - 'ntp4.aliyun.com'
    - 'ntp5.aliyun.com'
    - 'ntp6.aliyun.com'
    - 'ntp7.aliyun.com'
    - 'time1.aliyun.com'
    - 'time2.aliyun.com'
    - 'time3.aliyun.com'
    - 'time4.aliyun.com'
    - 'time5.aliyun.com'
    - 'time6.aliyun.com'
    - 'time7.aliyun.com'
    - '*.time.edu.cn'
    - 'time1.apple.com'
    - 'time2.apple.com'
    - 'time3.apple.com'
    - 'time4.apple.com'
    - 'time5.apple.com'
    - 'time6.apple.com'
    - 'time7.apple.com'
    - 'time1.google.com'
    - 'time2.google.com'
    - 'time3.google.com'
    - 'time4.google.com'
    - 'music.163.com'
    - '*.music.163.com'
    - '*.126.net'
    - 'musicapi.taihe.com'
    - 'music.taihe.com'
    - 'songsearch.kugou.com'
    - 'trackercdn.kugou.com'
    - '*.kuwo.cn'
    - 'api-jooxtt.sanook.com'
    - 'api.joox.com'
    - 'joox.com'
    - 'y.qq.com'
    - '*.y.qq.com'
    - 'streamoc.music.tc.qq.com'
    - 'mobileoc.music.tc.qq.com'
    - 'isure.stream.qqmusic.qq.com'
    - 'dl.stream.qqmusic.qq.com'
    - 'aqqmusic.tc.qq.com'
    - 'amobile.music.tc.qq.com'
    - '*.xiami.com'
    - '*.music.migu.cn'
    - 'music.migu.cn'
    - 'localhost.ptlogin2.qq.com'
tun:
  enable: true
  stack: system # or gvisor system
  dns-hijack:
    - 198.18.0.2:53 # when `fake-ip-range` is 198.18.0.1/16, should hijack 198.18.0.2:53
  auto-route: true # auto set global route for Windows
    # It is recommended to use `interface-name`
  auto-detect-interface: true # auto detect interface, conflict with `interface-name`
    
proxy-providers:
  BBQ: 
    type: http
    url: "https://pub-api-1.bianyuan.xyz/sub?target=clash&url=https%3A%2F%2Fdingyue.suying666.info%2Flink%2FNYGDcNY8wYHxIano%3Fclash%3D2&insert=false&exclude=0.4%7C0.5&emoji=true&list=true&tfo=false&scv=false&fdn=false&sort=false&new_name=true" 
    interval: 1800
    path: ./Proxy/BBQ.yaml 
    health-check:
      enable: true
      interval: 300
      url: https://www.gstatic.com/generate_204

  HK: 
    type: http
    url: "https://pub-api-1.bianyuan.xyz/sub?target=clash&url=https%3A%2F%2Fdingyue.suying666.info%2Flink%2FNYGDcNY8wYHxIano%3Fclash%3D2&insert=false&exclude=0.4%7C0.5%7C%E6%97%A5%E6%9C%AC%7C%E6%96%B0%E5%8A%A0%E5%9D%A1%7C%E7%BE%8E%E5%9B%BD%7C%E5%8F%B0%E6%B9%BE%7C%E4%BF%84%E7%BD%97%E6%96%AF&emoji=true&list=true&tfo=false&scv=false&fdn=false&sort=false&new_name=true" 
    interval: 1800
    path: ./Proxy/HK.yaml 
    health-check:
      enable: true
      interval: 300
      url: https://www.gstatic.com/generate_204

  TW: 
    type: http
    url: "https://pub-api-1.bianyuan.xyz/sub?target=clash&url=https%3A%2F%2Fdingyue.suying666.info%2Flink%2FNYGDcNY8wYHxIano%3Fclash%3D2&insert=false&exclude=0.4%7C0.5%7C%E6%97%A5%E6%9C%AC%7C%E6%96%B0%E5%8A%A0%E5%9D%A1%7C%E7%BE%8E%E5%9B%BD%7C%E9%A6%99%E6%B8%AF%7C%E4%BF%84%E7%BD%97%E6%96%AF&emoji=true&list=true&tfo=false&scv=false&fdn=false&sort=false&new_name=true" 
    interval: 1800
    path: ./Proxy/TW.yaml 
    health-check:
      enable: true
      interval: 300
      url: https://www.gstatic.com/generate_204

  JP: 
    type: http
    url: "https://pub-api-1.bianyuan.xyz/sub?target=clash&url=https%3A%2F%2Fdingyue.suying666.info%2Flink%2FNYGDcNY8wYHxIano%3Fclash%3D2&insert=false&exclude=0.4%7C0.5%7C%E5%8F%B0%E6%B9%BE%7C%E6%96%B0%E5%8A%A0%E5%9D%A1%7C%E7%BE%8E%E5%9B%BD%7C%E9%A6%99%E6%B8%AF%7C%E4%BF%84%E7%BD%97%E6%96%AF&emoji=true&list=true&tfo=false&scv=false&fdn=false&sort=false&new_name=true" 
    interval: 1800
    path: ./Proxy/JP.yaml 
    health-check:
      enable: true
      interval: 300
      url: https://www.gstatic.com/generate_204

  SG: 
    type: http
    url: "https://pub-api-1.bianyuan.xyz/sub?target=clash&url=https%3A%2F%2Fdingyue.suying666.info%2Flink%2FNYGDcNY8wYHxIano%3Fclash%3D2&insert=false&exclude=0.4%7C0.5%7C%E5%8F%B0%E6%B9%BE%7C%E6%97%A5%E6%9C%AC%7C%E7%BE%8E%E5%9B%BD%7C%E9%A6%99%E6%B8%AF%7C%E4%BF%84%E7%BD%97%E6%96%AF&emoji=true&list=true&tfo=false&scv=false&fdn=false&sort=false&new_name=true" 
    interval: 1800
    path: ./Proxy/SG.yaml 
    health-check:
      enable: true
      interval: 300
      url: https://www.gstatic.com/generate_204

#   US: 
#     type: http
#     url: "https://pub-api-1.bianyuan.xyz/sub?target=clash&url=https%3A%2F%2Fdingyue.suying666.info%2Flink%2FNYGDcNY8wYHxIano%3Fclash%3D2&insert=false&exclude=0.4%7C0.5%7C%E5%8F%B0%E6%B9%BE%7C%E6%97%A5%E6%9C%AC%7C%E6%96%B0%E5%8A%A0%E5%9D%A1%7C%E9%A6%99%E6%B8%AF%7C%E4%BF%84%E7%BD%97%E6%96%AF&emoji=true&list=true&tfo=false&scv=false&fdn=false&sort=false&new_name=true" 
#     interval: 1800
#     path: ./Proxy/US.yaml 
#     health-check:
#       enable: true
#       interval: 600
#       url: https://www.gstatic.com/generate_204

  RU: 
    type: http
    url: "https://pub-api-1.bianyuan.xyz/sub?target=clash&url=https%3A%2F%2Fdingyue.suying666.info%2Flink%2FNYGDcNY8wYHxIano%3Fclash%3D2&insert=false&exclude=0.4%7C0.5%7C%E5%8F%B0%E6%B9%BE%7C%E6%97%A5%E6%9C%AC%7C%E6%96%B0%E5%8A%A0%E5%9D%A1%7C%E9%A6%99%E6%B8%AF%7C%E7%BE%8E%E5%9B%BD&emoji=true&list=true&tfo=false&scv=false&fdn=false&sort=false&new_name=true" 
    interval: 1800
    path: ./Proxy/RU.yaml 
    health-check:
      enable: true
      interval: 300
      url: https://www.gstatic.com/generate_204

proxy-groups:
  - name: "最终选择"
    type: select
    proxies:
      - DIRECT
      - PROXY

  - name: "流媒体SE"
    type: select
    proxies:
      - DIRECT
      - 自动测速-香港
      - 自动测速-台湾

  - name: "PROXY"
    type: select
    proxies:
      - 自动测速-全局
      - 自动测速-新加坡
      - 自动测速-日本
      - 自动测速-香港
      - 自动测速-台湾
      - 自动测速-俄罗斯
    disable-udp: true
  
  - name: "流媒体"
    type: select
    proxies:
      - PROXY
      - 自动测速-新加坡
      - 自动测速-香港
      - 自动测速-日本
      - 自动测速-台湾
      - 自动测速-俄罗斯
    disable-udp: true

  - name: "自动测速-全局"
    use:
      - BBQ
    type: url-test
    url: https://www.google.com/generate_204
    interval: 300

  - name: "自动测速-香港"
    use:
      - HK
    type: url-test
    url: https://www.google.com/generate_204
    interval: 120

  - name: "自动测速-台湾"
    use:
      - TW
    type: url-test
    url: https://www.google.com/generate_204
    interval: 300

  - name: "自动测速-日本"
    use:
      - JP
    type: url-test
    url: https://www.google.com/generate_204
    interval: 300

  - name: "自动测速-新加坡"
    use:
      - SG
    type: url-test
    url: https://www.google.com/generate_204
    interval: 300

#   - name: "自动测速-美国"
#     use:
#       - US
#     type: url-test
#     url: https://www.google.com/generate_204
#     interval: 300

  - name: "自动测速-俄罗斯"
    use:
      - RU
    type: url-test
    url: https://www.google.com/generate_204
    interval: 300

rule-providers:
  ClashProxy:
    type: http
    behavior: classical
    path: ./RuleSet/ClashProxy.yaml
    url: "https://cdn.jsdelivr.net/gh/styxiik/FTW@main/Clash/rules/ClashProxy.yaml"
    interval: 7200

  ClashDirect:
    type: http
    behavior: classical
    path: ./RuleSet/ClashDirect.yaml
    url: "https://cdn.jsdelivr.net/gh/styxiik/FTW@main/Clash/rules/ClashDirect.yaml"
    interval: 7200

  ClashReject:
    type: http
    behavior: classical
    path: ./RuleSet/ClashReject.yaml
    url: "https://cdn.jsdelivr.net/gh/styxiik/FTW@main/Clash/rules/ClashReject.yaml"
    interval: 7200

  ClashStreaming:
    type: http
    behavior: classical
    path: ./RuleSet/ClashStreaming.yaml
    url: "https://cdn.jsdelivr.net/gh/styxiik/FTW@main/Clash/rules/ClashStreaming.yaml"
    interval: 7200
    
  Streaming:
    type: http
    behavior: classical
    path: ./RuleSet/Streaming.yaml
    url: "https://cdn.jsdelivr.net/gh/DivineEngine/Profiles@master/Clash/RuleSet/StreamingMedia/Streaming.yaml"
    interval: 7200

  StreamingSE:
    type: http
    behavior: classical
    path: ./RuleSet/StreamingSE.yaml
    url: "https://cdn.jsdelivr.net/gh/DivineEngine/Profiles@master/Clash/RuleSet/StreamingMedia/StreamingSE.yaml"
    interval: 7200
    
  AntiAd:
    type: http
    behavior: domain
    path: ./RuleSet/AntiAd.yaml
    url: "https://cdn.jsdelivr.net/gh/privacy-protection-tools/anti-AD@master/anti-ad-clash.yaml"
    interval: 7200
    
  Unbreak:
    type: http
    behavior: classical
    path: ./RuleSet/Unbreak.yaml
    url: "https://cdn.jsdelivr.net/gh/DivineEngine/Profiles@master/Clash/RuleSet/Unbreak.yaml"
    interval: 7200

  Global:
    type: http
    behavior: classical
    path: ./RuleSet/Global.yaml
    url: "https://cdn.jsdelivr.net/gh/DivineEngine/Profiles@master/Clash/RuleSet/Global.yaml"
    interval: 7200

  China:
    type: http
    behavior: classical
    path: ./RuleSet/China.yaml
    url: "https://cdn.jsdelivr.net/gh/DivineEngine/Profiles@master/Clash/RuleSet/China.yaml"
    interval: 7200

  ChinaIP:
    type: http
    behavior: ipcidr
    path: ./RuleSet/ChinaIP.yaml
    url: "https://cdn.jsdelivr.net/gh/DivineEngine/Profiles@master/Clash/RuleSet/Extra/ChinaIP.yaml"
    interval: 7200


rules:
  - RULE-SET,ClashProxy,PROXY
  - RULE-SET,ClashDirect,DIRECT
  - RULE-SET,ClashReject,REJECT
  - RULE-SET,ClashStreaming,流媒体
  - RULE-SET,StreamingSE,流媒体SE
  - RULE-SET,Streaming,流媒体
  - RULE-SET,AntiAd,REJECT
  - RULE-SET,Unbreak,DIRECT
  - RULE-SET,Global,PROXY
  - RULE-SET,China,DIRECT
  - IP-CIDR,192.168.0.0/16,DIRECT
  - IP-CIDR,10.0.0.0/8,DIRECT
  - IP-CIDR,172.16.0.0/12,DIRECT
  - IP-CIDR,127.0.0.0/8,DIRECT
  - IP-CIDR,100.64.0.0/10,DIRECT
  - IP-CIDR,224.0.0.0/4,DIRECT
  - RULE-SET,ChinaIP,DIRECT
  - GEOIP,CN,DIRECT

  - MATCH,最终选择
